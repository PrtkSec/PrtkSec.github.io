<!DOCTYPE html><html lang="en-US" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="Notes for Analysing Malicious PDF Documents" /><meta name="author" content="Pratik Patel" /><meta property="og:locale" content="en_US" /><meta name="description" content="Purpose" /><meta property="og:description" content="Purpose" /><link rel="canonical" href="https://prtksec.github.io/posts/MA_PDF_Notes/" /><meta property="og:url" content="https://prtksec.github.io/posts/MA_PDF_Notes/" /><meta property="og:site_name" content="PRATIK PATEL" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-06-09T00:00:00+12:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Notes for Analysing Malicious PDF Documents" /><meta name="twitter:site" content="@prtksec" /><meta name="twitter:creator" content="@Pratik Patel" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"Pratik Patel"},"description":"Purpose","url":"https://prtksec.github.io/posts/MA_PDF_Notes/","headline":"Notes for Analysing Malicious PDF Documents","@type":"BlogPosting","dateModified":"2021-06-10T20:45:10+12:00","datePublished":"2021-06-09T00:00:00+12:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://prtksec.github.io/posts/MA_PDF_Notes/"},"@context":"https://schema.org"}</script><title>Notes for Analysing Malicious PDF Documents | PRATIK PATEL</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/avatar.jpeg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">PRATIK PATEL</a></div><div class="site-subtitle font-italic">blog to capture my Cybersecurity journey</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://nz.linkedin.com/in/pratik-patel-oscp-459040a7" aria-label="linkedin" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href="https://github.com/prtksec" aria-label="github" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/prtksec" aria-label="twitter" class="order-5" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['pratik.patel','outlook.co.nz'].join('@')" aria-label="email" class="order-6" > <i class="fas fa-envelope"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Notes for Analysing Malicious PDF Documents</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Notes for Analysing Malicious PDF Documents</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Pratik Patel </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Wed, Jun 9, 2021, 12:00 AM +1200" prep="on" > Jun 9 <i class="unloaded">2021-06-09T00:00:00+12:00</i> </span></div><div> <span> <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Thu, Jun 10, 2021, 4:45 AM -0400" prefix="Updated " > Jun 10 <i class="unloaded">2021-06-10T20:45:10+12:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="995 words">5 min</span></div></div><div class="post-content"><h1 id="purpose">Purpose</h1><p>The purpose of this post is to cover steps &amp; tools for analysing malicious PDF documents. I will be using both the FlareVM and REMnux for analysis purposes. The steps taken will be covered in the following order below:</p><p><strong>1. Understand the PDF file structure</strong></p><p><strong>2. Identify point of interests during Analysis</strong></p><p><strong>3. Tools to find and extract data</strong></p><p>I will be using the following malicious PDF file (badpdf.pdf) throughout this post. The file is available from hybrid-analysis (HA) with the following hash:</p><blockquote><p><strong><em>MD5:</em></strong> 2264DD0EE26D8E3FBDF715DD0D807569</p></blockquote><blockquote><p><strong><em>SHA256:</em></strong> ad6cedb0d1244c1d740bf5f681850a275c4592281cdebb491ce533edd9d6a77d</p></blockquote><p>(WARNING! Download at your own risk!)</p><h2 id="1-understand-the-pdf-file-structure">1. Understand the PDF file structure</h2><p>PDF (Portable Document Format) is a file format used to present documents that include text, images, multimedia elements, web page links and more. it consists of objects contained in the body section of a PDF file; it also supports scripting capabilities in the form of Action Scripts (such as JavaScript).</p><p>There are 4 sections in a PDF file:</p><ol><li><strong>Header</strong> <em>(contains the version number of the pdf file)</em><li><strong>Body</strong> <em>(contains objects - obj values (1 0) denotes its name and its version number, obj &amp; endobj refers to the beginning and end of an object, contains catalog and stream objects)</em><li><strong>Cross Reference Table</strong> <em>(allows the pdf parser to quickly access every object inside the Body, begins with the keyword xref)</em><li><strong>Trailer</strong> (contains overall info about the PDF, points to the start of Cross Reference Table)</ol><p>the image below depicts the 4 sections as described above: <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/pdf_notes/pdf_structure.png" alt="alt text" /></p><h2 id="2-identify-point-of-interests-during-analysis">2. Identify point of interests during Analysis</h2><h2 id="pdf-element-actions">PDF Element Actions</h2><ul><li><strong>/OpenAction /AA</strong> - the function of this element is to carry out an action for e.g. execute a script<li><strong>/JavaScript /JS</strong> - link to the JavaScript that will run when the PDF is opened<li><strong>/Names</strong> - names of files that will likely be referred to by the PDF itself<li><strong>/EmbeddedFile</strong> - shows the other files embedded within the PDF file itself e.g., scripts<li><strong>/URI /SubmitForm</strong> - Links to other URLs on the internet e.g., possible link to a 2nd stage payload/additional tools for malware to run<li><strong>/Launch</strong> - Similar to OpenAction, can be used to run embedded scripts within the PDF file itself or run new additional files that have been downloaded by the PDF</ul><h2 id="pdf-strings-encoding--decoding">PDF Strings, Encoding &amp; Decoding</h2><p>PDF can encode strings in multiple ways to obfuscate data, the following example shows the string “Hello World” before and after hex encoding.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/pdf_notes/string_encode.png" alt="alt text" /></p><p>Some additional encoding examples: <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/pdf_notes/encoding.png" alt="alt text" /></p><p>To decode the encoded data PDF uses Filters, which tell the PDF reader that the corresponding string is supposed to be decoded using the provided method, as shown below: <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/pdf_notes/decode_1.png" alt="alt text" /></p><p>Example of multiple decode filters:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/pdf_notes/multiple_filters.png" alt="alt text" /></p><p>This has two levels of obfuscation, first is hex encoding and second is compression. The PDF reader will uncompress the stream data first before decoding the hex value (NOTE: Multiple filters are decoded in reverse).</p><h2 id="pdf-obfuscation-methods">PDF Obfuscation Methods</h2><ul><li><strong>/ASCIIHexDecode</strong> - hex encoding of characters<li><strong>/LZWDecode</strong> - LZW compression algorithm<li><strong>/FlateDecode</strong> - Zlib compression<li><strong>/ASCII85Decode</strong> - ASCII base-85 representation<li><strong>/Crypt</strong> - Various encryption algorithms</ul><h2 id="3-tools-to-find-and-extract-data">3. Tools to find and extract data</h2><ul><li><strong>pdfid</strong> - identifies PDF object types and filters (useful for triage of PDF documents), however it only indicates what is in the document not where<li><strong>pdf-parser</strong> - parses, searches and extracts data from PDF documents (use the pdfid tool first and then analyse the suspicious PDFs with pdf-parser)<li><strong>peepdf</strong> - is the combination of pdfid &amp; pdf-parser, as it is able to find suspicious objects, decode data and has JavaScript analysis built-ins<li><strong>YARA</strong> - a tool that is used to examine suspected files/directories and match strings as defined in the YARA rules with the file.</ul><h3 id="pdfid-in-flarevm--remnux">pdfid in FlareVM &amp; REMnux</h3><p>Commands:</p><blockquote><p><strong><em>FlareVM:</em></strong> <code class="language-plaintext highlighter-rouge">python pdfid.py "location of badpdf.pdf file"</code></p></blockquote><blockquote><p><strong><em>REMnux:</em></strong> <code class="language-plaintext highlighter-rouge">pdfid.py "location of badpdf.pdf file"</code></p></blockquote><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/pdf_notes/pdfid.png" alt="alt text" /></p><h3 id="pdf-parser-in-remnux-same-output-in-flarevm-but-looks-cleaner-on-remnux--">pdf-parser in REMnux (same output in FlareVM but looks cleaner on REMnux :) )</h3><p>as stated before, pdf-parser will extract all the data from a PDF. In order to narrow down to “the items of interest” we need to use the built-in command options such as ‘–Search’.</p><p>Use pdfparser with –search to show the /OpenAction object</p><blockquote><p><strong><em>REMnux:</em></strong> <code class="language-plaintext highlighter-rouge">pdf-parser.py --search openaction badpdf.pdf</code></p></blockquote><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/pdf_notes/openaction.png" alt="alt text" /></p><p>Now let’s search for the Javascript object with pdfparser</p><blockquote><p><strong><em>REMnux:</em></strong> <code class="language-plaintext highlighter-rouge">pdf-parser.py --search javascript badpdf.pdf</code></p></blockquote><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/pdf_notes/obj712.png" alt="alt text" /></p><p>locating object 10 and object 13 using the pdf parser</p><blockquote><p><strong><em>REMnux:</em></strong> <code class="language-plaintext highlighter-rouge">pdf-parser.py --object 10 badpdf.pdf</code></p></blockquote><blockquote><p><strong><em>REMnux:</em></strong> <code class="language-plaintext highlighter-rouge">pdf-parser.py --object 13 badpdf.pdf</code></p></blockquote><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/pdf_notes/obj1013.png" alt="alt text" /></p><p>To tell pdf-parser to apply the filter, use the -f (filter) &amp; -w (raw output) option:</p><blockquote><p><strong><em>REMnux:</em></strong> <code class="language-plaintext highlighter-rouge">pdf-parser.py --object 13 -f -w badpdf.pdf</code></p></blockquote><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/pdf_notes/rawoutput.png" alt="alt text" /></p><p>In order to format the code, we need to dump the output to a separate file and use a suitable JavaScript editor (Visual Studio Code). the command below will output a separate file</p><blockquote><p><strong><em>REMnux:</em></strong> <code class="language-plaintext highlighter-rouge">pdf-parser.py --object 13 -f -w -d obj13 badpdf.pdf</code></p></blockquote><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/pdf_notes/dump13.png" alt="alt text" /></p><p>use Visual Studio Code to open the file and examine the content.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/pdf_notes/vsdump.png" alt="alt text" /></p><p>I will analyse the code later, but for now let’s use pdf-parser with YARA rules to scan if the content in object 13 is malicious.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/pdf_notes/yaraparser.png" alt="alt text" /></p><p>so according to the above image, pdf-parser with YARA was able to detect the piece of code in object 13 as malicious.</p><h3 id="pee-pdf-in-remnux">pee-pdf in REMnux</h3><blockquote><p><strong><em>REMnux:</em></strong> <code class="language-plaintext highlighter-rouge">peepdf -i badpdf.pdf</code></p></blockquote><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/pdf_notes/peepdf.png" alt="alt text" /></p><p>We can also use the above hash values and check on virustotal if the file is malicious (which it is as shown below). we can further analyse the objects, let’s try object 13 as we know it contains the JavaScript code.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/pdf_notes/vtotal.png" alt="alt text" /></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/pdf_notes/obj13un.png" alt="alt text" /></p><p>we can also dump the object 13 content + JavaScript code to a file with the following command:</p><blockquote><p><strong><em>REMnux:</em></strong> <code class="language-plaintext highlighter-rouge">PPDF&gt; object 13 &gt; obj13.js</code></p></blockquote><p>That concludes the use of the peepdf tool.</p><h1 id="summary">Summary</h1><p>All of the tools used above proved to be quite useful for PDF document analysis. Peepdf definitely has the upper hand over pdfid and pdf-parser as they require a lot of manual analysis. All in all they are all quite useful when used in conjunction (pdfid + pdf-parser + YARA).</p><h1 id="references">References</h1><div class="table-wrapper"><table><thead><tr><th>Description<th>Link<tbody><tr><td>Hybrid Analysis badpdf.pdf file (WARNING! Download at your own risk!)<td>https://www.hybrid-analysis.com/sample/ad6cedb0d1244c1d740bf5f681850a275c4592281cdebb491ce533edd9d6a77d/5ba8ca967ca3e15fe24d1c93<tr><td>Flare VM (for Malware Analysis)<td>https://github.com/fireeye/flare-vm<tr><td>REMnux VM (for Malware Analysis)<td>https://docs.remnux.org/install-distro/get-virtual-appliance</table></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/malware-analysis-notes/'>Malware Analysis Notes</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/pdf-analysis/" class="post-tag no-text-decoration" >PDF Analysis</a> <a href="/tags/pdfid/" class="post-tag no-text-decoration" >pdfid</a> <a href="/tags/pdf-parser/" class="post-tag no-text-decoration" >pdf-parser</a> <a href="/tags/peepdf/" class="post-tag no-text-decoration" >peepdf</a> <a href="/tags/yara/" class="post-tag no-text-decoration" >YARA</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Notes for Analysing Malicious PDF Documents - PRATIK PATEL&url=https://prtksec.github.io/posts/MA_PDF_Notes/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Notes for Analysing Malicious PDF Documents - PRATIK PATEL&u=https://prtksec.github.io/posts/MA_PDF_Notes/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Notes for Analysing Malicious PDF Documents - PRATIK PATEL&url=https://prtksec.github.io/posts/MA_PDF_Notes/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/MB_FIN7/">*in progress* Malware Breakdown - FIN7 Spear Phishing Email</a><li><a href="/posts/MA_PDF_Notes/">Notes for Analysing Malicious PDF Documents</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/attachment/">attachment</a> <a class="post-tag" href="/tags/e-mail/">e-mail</a> <a class="post-tag" href="/tags/fin7/">FIN7</a> <a class="post-tag" href="/tags/flare-vm/">Flare VM</a> <a class="post-tag" href="/tags/macros/">macros</a> <a class="post-tag" href="/tags/pdf-analysis/">PDF Analysis</a> <a class="post-tag" href="/tags/pdf-parser/">pdf-parser</a> <a class="post-tag" href="/tags/pdfid/">pdfid</a> <a class="post-tag" href="/tags/peepdf/">peepdf</a> <a class="post-tag" href="/tags/spear-phishing/">Spear Phishing</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/MB_FIN7/"><div class="card-body"> <span class="timeago small" > May 20 <i class="unloaded">2021-05-20T00:00:00+12:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>*in progress* Malware Breakdown - FIN7 Spear Phishing Email</h3><div class="text-muted small"><p> Background The FIN7 Spear Phishing campaign was an APT attack which involved targeting personnel of the United States Securities and Exchange Commission (SEC) filings at various organizations. The...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/MB_FIN7/" class="btn btn-outline-primary" prompt="Older"><p>*in progress* Malware Breakdown - FIN7 Spear Phishing Email</p></a> <span class="btn btn-outline-primary disabled" prompt="Newer"><p>-</p></span></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('#main > div.row:first-child > div:first-child img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://twitter.com/username">Pratik Patel</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/attachment/">attachment</a> <a class="post-tag" href="/tags/e-mail/">e mail</a> <a class="post-tag" href="/tags/fin7/">FIN7</a> <a class="post-tag" href="/tags/flare-vm/">Flare VM</a> <a class="post-tag" href="/tags/macros/">macros</a> <a class="post-tag" href="/tags/pdf-analysis/">PDF Analysis</a> <a class="post-tag" href="/tags/pdf-parser/">pdf parser</a> <a class="post-tag" href="/tags/pdfid/">pdfid</a> <a class="post-tag" href="/tags/peepdf/">peepdf</a> <a class="post-tag" href="/tags/spear-phishing/">Spear Phishing</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://prtksec.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
